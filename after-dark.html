<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Signature D — After-Dark Members Lounge</title>
  <meta name="description" content="A classy, late-night members lounge to network boldly — never vulgar." />
  <link rel="icon" href="favicon.ico" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- CSP for Firebase modules -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 img-src 'self' https: data:;
                 style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
                 font-src https://fonts.gstatic.com;
                 script-src 'self' https://www.gstatic.com https://www.googleapis.com;
                 connect-src https://firestore.googleapis.com https://www.googleapis.com https://www.gstatic.com 'self';
                 frame-src https:;">

  <style>
    :root{--emerald:#0b2e2e;--emeraldGlow:#0e3f3f;--gold:#f5c046;--goldBright:#ffd978;--ink:#050709;--silver:#e6eaef}
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--ink);color:var(--silver);font-family:Inter,system-ui,sans-serif}
    .container{max-width:1100px;margin:0 auto;padding:24px}
    header{position:sticky;top:0;z-index:60;background:rgba(5,7,9,.75);backdrop-filter:saturate(180%) blur(10px);border-bottom:1px solid rgba(230,234,239,.08)}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:38px;height:38px;border-radius:12px;background:radial-gradient(60% 60% at 50% 40%, var(--goldBright), var(--gold))}
    h1{font-family:"Playfair Display",serif;font-size:22px;margin:0}
    .btn{display:inline-block;padding:10px 14px;border-radius:12px;border:1px solid rgba(230,234,239,.14);transition:transform .2s ease,box-shadow .2s ease;cursor:pointer}
    .btn:hover{transform:translateY(-2px);box-shadow:0 10px 24px rgba(0,0,0,.35)}
    .btn.gold{background:linear-gradient(135deg,var(--gold),var(--goldBright));color:#181a1e;border-color:rgba(0,0,0,.15)}
    .hero{position:relative;overflow:hidden;border-bottom:1px solid rgba(230,234,239,.08)}
    .heroBg{position:absolute;inset:0;background:
      radial-gradient(1000px 600px at 70% -10%, rgba(14,63,63,.45), transparent),
      radial-gradient(900px 500px at -10% 20%, rgba(9,44,44,.5), transparent),
      linear-gradient(180deg, rgba(5,7,9,1) 0%, rgba(5,7,9,.4) 60%, rgba(5,7,9,1) 100%)}
    .starfield{position:absolute;inset:0;pointer-events:none;background-image:radial-gradient(#ffffff 1px, rgba(255,255,255,0) 2px);background-size:3px 3px;opacity:.10;animation:twinkle 7s linear infinite}
    @keyframes twinkle{0%{opacity:.06}50%{opacity:.12}100%{opacity:.06}}
    .heroInner{position:relative;padding:72px 24px 40px}
    .kicker{letter-spacing:.22em;text-transform:uppercase;color:#cfe1de;font-size:12px;margin-bottom:10px}
    .hero h2{font-family:"Playfair Display",serif;font-size:40px;margin:0 0 8px}
    .grid{display:grid;gap:16px}
    @media(min-width:980px){.cols-2{grid-template-columns:1.1fr .9fr}}
    .panel{border:1px solid rgba(230,234,239,.12);border-radius:18px;background:linear-gradient(145deg, rgba(14,63,63,.25), rgba(5,7,9,.9));box-shadow:0 18px 40px rgba(0,0,0,.45)}
    .panelHeader{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid rgba(230,234,239,.08)}
    .chatWrap{display:flex;flex-direction:column;height:62vh}
    .msgs{flex:1;overflow:auto;padding:14px 16px}
    .msg{margin:10px 0;padding:10px 12px;border-radius:14px;border:1px solid rgba(230,234,239,.08);background:rgba(255,255,255,.03);max-width:78%}
    .me{margin-left:auto;background:linear-gradient(135deg, rgba(255,217,120,.12), rgba(255,255,255,.03));border-color:rgba(255,217,120,.28)}
    .nick{font-weight:600;color:var(--gold);font-size:13px}
    .time{font-size:11px;opacity:.6;margin-left:6px}
    .composer{display:flex;gap:10px;padding:12px;border-top:1px solid rgba(230,234,239,.08)}
    .composer input{flex:1;padding:12px 14px;border-radius:12px;border:1px solid rgba(230,234,239,.18);background:rgba(255,255,255,.06);color:var(--silver)}
    .rules{padding:16px}
    .rules h4{margin:0 0 8px;font-family:"Playfair Display",serif}
    .rules ul{margin:8px 0 0 18px}
    .rules li{margin:6px 0}
    footer{padding:26px 24px;border-top:1px solid rgba(230,234,239,.08)}
    .fine{opacity:.75}
    /* Gate */
    .gate{position:fixed;inset:0;background:rgba(5,7,9,.86);backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:center;z-index:100}
    .gateCard{width:min(560px,92%);border-radius:20px;border:1px solid rgba(230,234,239,.14);background:linear-gradient(145deg, rgba(14,63,63,.35), rgba(5,7,9,.95));padding:26px;box-shadow:0 22px 50px rgba(0,0,0,.5)}
    .row{display:flex;gap:10px;margin-top:10px}
    input[type="text"], input[type="password"]{flex:1;padding:12px 14px;border-radius:12px;border:1px solid rgba(230,234,239,.18);background:rgba(255,255,255,.06);color:var(--silver)}
    .err{color:#ffd0d0;font-size:13px;display:none;margin-top:6px}
  </style>
</head>
<body>
  <header>
    <div class="container" style="display:flex;justify-content:space-between;align-items:center">
      <div class="brand"><div class="logo" aria-hidden="true"></div><h1>Signature D — After-Dark</h1></div>
      <a class="btn" href="index.html">Back to Home</a>
    </div>
  </header>

  <section class="hero" aria-label="Hero">
    <div class="heroBg"></div><div class="starfield"></div>
    <div class="heroInner container">
      <div class="kicker">Members Lounge • Invite Only</div>
      <h2>Freedom of Speech. Class in Delivery.</h2>
      <p class="fine">A comfortable late-night space to network boldly — never vulgar. Keep it sharp, respectful, and unforgettable.</p>
    </div>
  </section>

  <main class="container grid cols-2" style="margin-top:16px">
    <section class="panel">
      <div class="panelHeader">
        <div><strong>Room:</strong> After-Dark</div>
        <div id="who" class="fine">Not connected</div>
      </div>
      <div class="chatWrap">
        <div id="msgs" class="msgs" aria-live="polite"></div>
        <div class="composer">
          <input id="message" type="text" placeholder="Say something classy… (Enter to send)" aria-label="Message" />
          <button class="btn gold" id="send" type="button">Send</button>
        </div>
      </div>
    </section>

    <aside class="panel rules">
      <h4>House Rules (After-Dark)</h4>
      <ul>
        <li><strong>Freedom, not filth:</strong> smart, bold takes encouraged; hateful or explicit content isn’t.</li>
        <li><strong>No harassment:</strong> debate ideas, not people. No doxxing, threats, or slurs.</li>
        <li><strong>Show receipts:</strong> share wins, offers, and opportunities with context.</li>
        <li><strong>DM etiquette:</strong> ask before moving to DMs; no spam.</li>
        <li><strong>Keep it cinematic:</strong> polished language > vulgar shock.</li>
      </ul>
      <p class="fine" style="margin-top:10px">Violations may be removed. Repeat offenders lose access.</p>
    </aside>
  </main>

  <footer>
    <div class="container" style="display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px;align-items:center">
      <div>© <span id="yr"></span> DeVirn Signature House, Inc.</div>
      <div class="fine">We don’t chase attention — we own it.</div>
    </div>
  </footer>

  <!-- Access/Nickname Gate -->
  <div class="gate" id="gate" aria-modal="true" role="dialog">
    <div class="gateCard">
      <h3>Enter the Members Lounge</h3>
      <p class="fine">Set your display name and access code.</p>
      <div class="row"><input type="text" id="nick" placeholder="Display name (e.g., Devon • Sahara)" /></div>
      <div class="row"><input type="password" id="code" placeholder="Access code" /></div>
      <div class="row"><button class="btn gold" id="enter" type="button">Enter Lounge</button></div>
      <div class="err" id="err">Check your name and code.</div>
      <p class="fine" style="margin-top:12px">No code? <a href="mailto:narinedevirn@gmail.com">Request access</a>.</p>
    </div>
  </div>

  <!-- Firebase chat (client-only) -->
  <script type="module">
    // 1) Replace with your Firebase config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp, query, orderBy, limit, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // 2) Simple gate
    const gate=document.getElementById('gate'); const err=document.getElementById('err');
    const code=document.getElementById('code'); const nick=document.getElementById('nick'); const who=document.getElementById('who');
    const ACCESS_CODE='MIDNIGHT'; // TODO: change this
    document.getElementById('enter').addEventListener('click',()=>{
      const n=(nick.value||'').trim(); const c=(code.value||'').trim().toUpperCase();
      if(n.length<2 || c!==ACCESS_CODE){ err.style.display='block'; return; }
      sessionStorage.setItem('sd_afterdark_ok','1'); sessionStorage.setItem('sd_afterdark_nick',n);
      gate.style.display='none'; who.textContent = `Signed in as ${n}`;
      nick.value=''; code.value='';
    });
    if(sessionStorage.getItem('sd_afterdark_ok')==='1'){
      gate.style.display='none';
      who.textContent=`Signed in as ${sessionStorage.getItem('sd_afterdark_nick')||'Member'}`;
    }

    // 3) Basic filter
    const banned=['fuck','shit','bitch','cunt','nigger','faggot','slut','whore','rape','kill yourself'];
    const filter=(t)=>{ let strikes=0, out=t; banned.forEach(w=>{ const re=new RegExp(w,'ig'); if(re.test(out)){ strikes++; out=out.replace(re,'•'.repeat(Math.min(3,w.length))); } }); return {text:out.trim(), ok:strikes<2}; };

    // 4) Chat
    const msgsEl=document.getElementById('msgs'); const input=document.getElementById('message'); const sendBtn=document.getElementById('send');
    const roomRef=collection(db,'afterdark'); const q=query(roomRef, orderBy('ts','desc'), limit(50));
    const render=(doc, meName)=>{ const d=doc.data(); const wrap=document.createElement('div'); const mine=meName && d.nick===meName; wrap.className='msg'+(mine?' me':''); const t=d.ts?.toDate? d.ts.toDate():new Date();
      wrap.innerHTML=`<div class="nick">${d.nick||'Member'} <span class="time">${t.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}</span></div><div class="body">${(d.text||'').replace(/</g,'&lt;')}</div>`;
      msgsEl.appendChild(wrap); msgsEl.scrollTop=msgsEl.scrollHeight; };
    onSnapshot(q,(snap)=>{ msgsEl.innerHTML=''; const meName=sessionStorage.getItem('sd_afterdark_nick'); const docs=snap.docs.slice().reverse(); docs.forEach(d=>render(d,meName)); });
    async function send(){ const me=sessionStorage.getItem('sd_afterdark_nick')||'Member'; const raw=(input.value||'').trim(); if(!raw) return; const f=filter(raw); if(!f.ok){ alert('Let’s keep it classy. Try again.'); return; } await addDoc(roomRef,{nick:me,text:f.text,ts:serverTimestamp()}); input.value=''; }
    sendBtn.addEventListener('click',send); input.addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ send(); } });

    document.getElementById('yr').textContent=new Date().getFullYear();
  </script>
  <script>document.getElementById('yr').textContent=new Date().getFullYear();</script>
</body>
</html>
